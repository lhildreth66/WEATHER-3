{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":120,"column":0,"index":3711}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"react-native-web/dist/exports/AppState","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":120,"column":0,"index":3711}}],"key":"gBUxmszTgjVtvpoOB6dRiFs/1a8="}},{"name":"../services/notifications","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":4,"column":0,"index":163},"end":{"line":10,"column":35,"index":382}}],"key":"TGplvkV1KKwMFQBc1oX8XaHJCok="}},{"name":"../apiConfig","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":11,"column":0,"index":383},"end":{"line":11,"column":40,"index":423}}],"key":"MaupMNrTUu0qeD5l6mX7OBgVinQ="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useNotifications = useNotifications;\n  var _react = require(_dependencyMap[1], \"react\");\n  var _AppState = _interopRequireDefault(require(_dependencyMap[2], \"react-native-web/dist/exports/AppState\"));\n  var _notifications = require(_dependencyMap[3], \"../services/notifications\");\n  var _apiConfig = require(_dependencyMap[4], \"../apiConfig\");\n  /**\n   * Hook for managing push notifications\n   * \n   * Usage:\n   * ```tsx\n   * const { expoPushToken, notification, isRegistered, registerForNotifications } = useNotifications();\n   * \n   * useEffect(() => {\n   *   if (notification) {\n   *     // Handle incoming notification\n   *     console.log('Received:', notification.request.content.body);\n   *   }\n   * }, [notification]);\n   * ```\n   */\n  function useNotifications() {\n    const [expoPushToken, setExpoPushToken] = (0, _react.useState)(null);\n    const [notification, setNotification] = (0, _react.useState)(null);\n    const [isRegistered, setIsRegistered] = (0, _react.useState)(false);\n    const [error, setError] = (0, _react.useState)(null);\n    const notificationListener = (0, _react.useRef)();\n    const responseListener = (0, _react.useRef)();\n    const appState = (0, _react.useRef)(_AppState.default.currentState);\n    const registerForNotifications = async () => {\n      try {\n        setError(null);\n        const token = await (0, _notifications.registerForPushNotificationsAsync)();\n        if (token) {\n          setExpoPushToken(token);\n          setIsRegistered(true);\n\n          // Send token to backend if API_BASE is configured\n          if (_apiConfig.API_BASE) {\n            await (0, _notifications.sendPushTokenToBackend)(token, _apiConfig.API_BASE);\n          }\n        } else {\n          setError('Could not get push notification token');\n        }\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Unknown error');\n      }\n    };\n    (0, _react.useEffect)(() => {\n      // Register for notifications on mount\n      registerForNotifications();\n\n      // Set up notification listeners\n      notificationListener.current = (0, _notifications.addNotificationReceivedListener)(notif => {\n        setNotification(notif);\n      });\n      responseListener.current = (0, _notifications.addNotificationResponseReceivedListener)(response => {\n        // Handle notification tap - navigate to relevant screen\n        const data = response.notification.request.content.data;\n        console.log('Notification tapped:', data);\n\n        // You can add navigation logic here based on data.screen or data.route\n      });\n\n      // Handle app state changes to refresh token when app comes to foreground\n      const handleAppStateChange = nextAppState => {\n        if (appState.current.match(/inactive|background/) && nextAppState === 'active') {\n          // App has come to the foreground - refresh registration if needed\n          if (!isRegistered) {\n            registerForNotifications();\n          }\n        }\n        appState.current = nextAppState;\n      };\n      const subscription = _AppState.default.addEventListener('change', handleAppStateChange);\n\n      // Cleanup\n      return () => {\n        if (notificationListener.current) {\n          (0, _notifications.removeNotificationSubscription)(notificationListener.current);\n        }\n        if (responseListener.current) {\n          (0, _notifications.removeNotificationSubscription)(responseListener.current);\n        }\n        subscription.remove();\n      };\n    }, []);\n    return {\n      expoPushToken,\n      notification,\n      isRegistered,\n      error,\n      registerForNotifications\n    };\n  }\n});","lineCount":100,"map":[[7,2,1,0],[7,6,1,0,"_react"],[7,12,1,0],[7,15,1,0,"require"],[7,22,1,0],[7,23,1,0,"_dependencyMap"],[7,37,1,0],[8,2,1,52],[8,6,1,52,"_AppState"],[8,15,1,52],[8,18,1,52,"_interopRequireDefault"],[8,40,1,52],[8,41,1,52,"require"],[8,48,1,52],[8,49,1,52,"_dependencyMap"],[8,63,1,52],[9,2,4,0],[9,6,4,0,"_notifications"],[9,20,4,0],[9,23,4,0,"require"],[9,30,4,0],[9,31,4,0,"_dependencyMap"],[9,45,4,0],[10,2,11,0],[10,6,11,0,"_apiConfig"],[10,16,11,0],[10,19,11,0,"require"],[10,26,11,0],[10,27,11,0,"_dependencyMap"],[10,41,11,0],[11,2,21,0],[12,0,22,0],[13,0,23,0],[14,0,24,0],[15,0,25,0],[16,0,26,0],[17,0,27,0],[18,0,28,0],[19,0,29,0],[20,0,30,0],[21,0,31,0],[22,0,32,0],[23,0,33,0],[24,0,34,0],[25,0,35,0],[26,2,36,7],[26,11,36,16,"useNotifications"],[26,27,36,32,"useNotifications"],[26,28,36,32],[26,30,36,59],[27,4,37,2],[27,10,37,8],[27,11,37,9,"expoPushToken"],[27,24,37,22],[27,26,37,24,"setExpoPushToken"],[27,42,37,40],[27,43,37,41],[27,46,37,44],[27,50,37,44,"useState"],[27,65,37,52],[27,67,37,68],[27,71,37,72],[27,72,37,73],[28,4,38,2],[28,10,38,8],[28,11,38,9,"notification"],[28,23,38,21],[28,25,38,23,"setNotification"],[28,40,38,38],[28,41,38,39],[28,44,38,42],[28,48,38,42,"useState"],[28,63,38,50],[28,65,38,86],[28,69,38,90],[28,70,38,91],[29,4,39,2],[29,10,39,8],[29,11,39,9,"isRegistered"],[29,23,39,21],[29,25,39,23,"setIsRegistered"],[29,40,39,38],[29,41,39,39],[29,44,39,42],[29,48,39,42,"useState"],[29,63,39,50],[29,65,39,51],[29,70,39,56],[29,71,39,57],[30,4,40,2],[30,10,40,8],[30,11,40,9,"error"],[30,16,40,14],[30,18,40,16,"setError"],[30,26,40,24],[30,27,40,25],[30,30,40,28],[30,34,40,28,"useState"],[30,49,40,36],[30,51,40,52],[30,55,40,56],[30,56,40,57],[31,4,42,2],[31,10,42,8,"notificationListener"],[31,30,42,28],[31,33,42,31],[31,37,42,31,"useRef"],[31,50,42,37],[31,52,42,66],[31,53,42,67],[32,4,43,2],[32,10,43,8,"responseListener"],[32,26,43,24],[32,29,43,27],[32,33,43,27,"useRef"],[32,46,43,33],[32,48,43,62],[32,49,43,63],[33,4,44,2],[33,10,44,8,"appState"],[33,18,44,16],[33,21,44,19],[33,25,44,19,"useRef"],[33,38,44,25],[33,40,44,26,"AppState"],[33,57,44,34],[33,58,44,35,"currentState"],[33,70,44,47],[33,71,44,48],[34,4,46,2],[34,10,46,8,"registerForNotifications"],[34,34,46,32],[34,37,46,35],[34,43,46,35,"registerForNotifications"],[34,44,46,35],[34,49,46,47],[35,6,47,4],[35,10,47,8],[36,8,48,6,"setError"],[36,16,48,14],[36,17,48,15],[36,21,48,19],[36,22,48,20],[37,8,49,6],[37,14,49,12,"token"],[37,19,49,17],[37,22,49,20],[37,28,49,26],[37,32,49,26,"registerForPushNotificationsAsync"],[37,80,49,59],[37,82,49,60],[37,83,49,61],[38,8,51,6],[38,12,51,10,"token"],[38,17,51,15],[38,19,51,17],[39,10,52,8,"setExpoPushToken"],[39,26,52,24],[39,27,52,25,"token"],[39,32,52,30],[39,33,52,31],[40,10,53,8,"setIsRegistered"],[40,25,53,23],[40,26,53,24],[40,30,53,28],[40,31,53,29],[42,10,55,8],[43,10,56,8],[43,14,56,12,"API_BASE"],[43,33,56,20],[43,35,56,22],[44,12,57,10],[44,18,57,16],[44,22,57,16,"sendPushTokenToBackend"],[44,59,57,38],[44,61,57,39,"token"],[44,66,57,44],[44,68,57,46,"API_BASE"],[44,87,57,54],[44,88,57,55],[45,10,58,8],[46,8,59,6],[46,9,59,7],[46,15,59,13],[47,10,60,8,"setError"],[47,18,60,16],[47,19,60,17],[47,58,60,56],[47,59,60,57],[48,8,61,6],[49,6,62,4],[49,7,62,5],[49,8,62,6],[49,15,62,13,"err"],[49,18,62,16],[49,20,62,18],[50,8,63,6,"setError"],[50,16,63,14],[50,17,63,15,"err"],[50,20,63,18],[50,32,63,30,"Error"],[50,37,63,35],[50,40,63,38,"err"],[50,43,63,41],[50,44,63,42,"message"],[50,51,63,49],[50,54,63,52],[50,69,63,67],[50,70,63,68],[51,6,64,4],[52,4,65,2],[52,5,65,3],[53,4,67,2],[53,8,67,2,"useEffect"],[53,24,67,11],[53,26,67,12],[53,32,67,18],[54,6,68,4],[55,6,69,4,"registerForNotifications"],[55,30,69,28],[55,31,69,29],[55,32,69,30],[57,6,71,4],[58,6,72,4,"notificationListener"],[58,26,72,24],[58,27,72,25,"current"],[58,34,72,32],[58,37,72,35],[58,41,72,35,"addNotificationReceivedListener"],[58,87,72,66],[58,89,72,68,"notif"],[58,94,72,73],[58,98,72,78],[59,8,73,6,"setNotification"],[59,23,73,21],[59,24,73,22,"notif"],[59,29,73,27],[59,30,73,28],[60,6,74,4],[60,7,74,5],[60,8,74,6],[61,6,76,4,"responseListener"],[61,22,76,20],[61,23,76,21,"current"],[61,30,76,28],[61,33,76,31],[61,37,76,31,"addNotificationResponseReceivedListener"],[61,91,76,70],[61,93,76,72,"response"],[61,101,76,80],[61,105,76,85],[62,8,77,6],[63,8,78,6],[63,14,78,12,"data"],[63,18,78,16],[63,21,78,19,"response"],[63,29,78,27],[63,30,78,28,"notification"],[63,42,78,40],[63,43,78,41,"request"],[63,50,78,48],[63,51,78,49,"content"],[63,58,78,56],[63,59,78,57,"data"],[63,63,78,61],[64,8,79,6,"console"],[64,15,79,13],[64,16,79,14,"log"],[64,19,79,17],[64,20,79,18],[64,42,79,40],[64,44,79,42,"data"],[64,48,79,46],[64,49,79,47],[66,8,81,6],[67,6,82,4],[67,7,82,5],[67,8,82,6],[69,6,84,4],[70,6,85,4],[70,12,85,10,"handleAppStateChange"],[70,32,85,30],[70,35,85,34,"nextAppState"],[70,47,85,62],[70,51,85,67],[71,8,86,6],[71,12,87,8,"appState"],[71,20,87,16],[71,21,87,17,"current"],[71,28,87,24],[71,29,87,25,"match"],[71,34,87,30],[71,35,87,31],[71,56,87,52],[71,57,87,53],[71,61,88,8,"nextAppState"],[71,73,88,20],[71,78,88,25],[71,86,88,33],[71,88,89,8],[72,10,90,8],[73,10,91,8],[73,14,91,12],[73,15,91,13,"isRegistered"],[73,27,91,25],[73,29,91,27],[74,12,92,10,"registerForNotifications"],[74,36,92,34],[74,37,92,35],[74,38,92,36],[75,10,93,8],[76,8,94,6],[77,8,95,6,"appState"],[77,16,95,14],[77,17,95,15,"current"],[77,24,95,22],[77,27,95,25,"nextAppState"],[77,39,95,37],[78,6,96,4],[78,7,96,5],[79,6,98,4],[79,12,98,10,"subscription"],[79,24,98,22],[79,27,98,25,"AppState"],[79,44,98,33],[79,45,98,34,"addEventListener"],[79,61,98,50],[79,62,98,51],[79,70,98,59],[79,72,98,61,"handleAppStateChange"],[79,92,98,81],[79,93,98,82],[81,6,100,4],[82,6,101,4],[82,13,101,11],[82,19,101,17],[83,8,102,6],[83,12,102,10,"notificationListener"],[83,32,102,30],[83,33,102,31,"current"],[83,40,102,38],[83,42,102,40],[84,10,103,8],[84,14,103,8,"removeNotificationSubscription"],[84,59,103,38],[84,61,103,39,"notificationListener"],[84,81,103,59],[84,82,103,60,"current"],[84,89,103,67],[84,90,103,68],[85,8,104,6],[86,8,105,6],[86,12,105,10,"responseListener"],[86,28,105,26],[86,29,105,27,"current"],[86,36,105,34],[86,38,105,36],[87,10,106,8],[87,14,106,8,"removeNotificationSubscription"],[87,59,106,38],[87,61,106,39,"responseListener"],[87,77,106,55],[87,78,106,56,"current"],[87,85,106,63],[87,86,106,64],[88,8,107,6],[89,8,108,6,"subscription"],[89,20,108,18],[89,21,108,19,"remove"],[89,27,108,25],[89,28,108,26],[89,29,108,27],[90,6,109,4],[90,7,109,5],[91,4,110,2],[91,5,110,3],[91,7,110,5],[91,9,110,7],[91,10,110,8],[92,4,112,2],[92,11,112,9],[93,6,113,4,"expoPushToken"],[93,19,113,17],[94,6,114,4,"notification"],[94,18,114,16],[95,6,115,4,"isRegistered"],[95,18,115,16],[96,6,116,4,"error"],[96,11,116,9],[97,6,117,4,"registerForNotifications"],[98,4,118,2],[98,5,118,3],[99,2,119,0],[100,0,119,1],[100,3]],"functionMap":{"names":["<global>","useNotifications","registerForNotifications","useEffect$argument_0","addNotificationReceivedListener$argument_0","addNotificationResponseReceivedListener$argument_0","handleAppStateChange","<anonymous>"],"mappings":"AAA;OCmC;mCCU;GDmB;YEE;mECK;KDE;uEEE;KFM;iCGG;KHW;WIK;KJQ;GFC;CDS"}},"type":"js/module"}]}