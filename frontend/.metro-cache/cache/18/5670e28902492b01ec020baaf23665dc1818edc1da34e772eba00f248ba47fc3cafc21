{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":120,"column":0,"index":3711}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"react-native-web/dist/exports/AppState","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":120,"column":0,"index":3711}}],"key":"gBUxmszTgjVtvpoOB6dRiFs/1a8="}},{"name":"../services/notifications","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":4,"column":0,"index":163},"end":{"line":10,"column":35,"index":382}}],"key":"TGplvkV1KKwMFQBc1oX8XaHJCok="}},{"name":"../apiConfig","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":11,"column":0,"index":383},"end":{"line":11,"column":40,"index":423}}],"key":"MaupMNrTUu0qeD5l6mX7OBgVinQ="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.useNotifications = useNotifications;\n  var _react = require(_dependencyMap[1], \"react\");\n  var _AppState = _interopRequireDefault(require(_dependencyMap[2], \"react-native-web/dist/exports/AppState\"));\n  var _notifications = require(_dependencyMap[3], \"../services/notifications\");\n  var _apiConfig = require(_dependencyMap[4], \"../apiConfig\");\n  var _s = $RefreshSig$();\n  /**\n   * Hook for managing push notifications\n   * \n   * Usage:\n   * ```tsx\n   * const { expoPushToken, notification, isRegistered, registerForNotifications } = useNotifications();\n   * \n   * useEffect(() => {\n   *   if (notification) {\n   *     // Handle incoming notification\n   *     console.log('Received:', notification.request.content.body);\n   *   }\n   * }, [notification]);\n   * ```\n   */\n  function useNotifications() {\n    _s();\n    const [expoPushToken, setExpoPushToken] = (0, _react.useState)(null);\n    const [notification, setNotification] = (0, _react.useState)(null);\n    const [isRegistered, setIsRegistered] = (0, _react.useState)(false);\n    const [error, setError] = (0, _react.useState)(null);\n    const notificationListener = (0, _react.useRef)();\n    const responseListener = (0, _react.useRef)();\n    const appState = (0, _react.useRef)(_AppState.default.currentState);\n    const registerForNotifications = async () => {\n      try {\n        setError(null);\n        const token = await (0, _notifications.registerForPushNotificationsAsync)();\n        if (token) {\n          setExpoPushToken(token);\n          setIsRegistered(true);\n\n          // Send token to backend if API_BASE is configured\n          if (_apiConfig.API_BASE) {\n            await (0, _notifications.sendPushTokenToBackend)(token, _apiConfig.API_BASE);\n          }\n        } else {\n          setError('Could not get push notification token');\n        }\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Unknown error');\n      }\n    };\n    (0, _react.useEffect)(() => {\n      // Register for notifications on mount\n      registerForNotifications();\n\n      // Set up notification listeners\n      notificationListener.current = (0, _notifications.addNotificationReceivedListener)(notif => {\n        setNotification(notif);\n      });\n      responseListener.current = (0, _notifications.addNotificationResponseReceivedListener)(response => {\n        // Handle notification tap - navigate to relevant screen\n        const data = response.notification.request.content.data;\n        console.log('Notification tapped:', data);\n\n        // You can add navigation logic here based on data.screen or data.route\n      });\n\n      // Handle app state changes to refresh token when app comes to foreground\n      const handleAppStateChange = nextAppState => {\n        if (appState.current.match(/inactive|background/) && nextAppState === 'active') {\n          // App has come to the foreground - refresh registration if needed\n          if (!isRegistered) {\n            registerForNotifications();\n          }\n        }\n        appState.current = nextAppState;\n      };\n      const subscription = _AppState.default.addEventListener('change', handleAppStateChange);\n\n      // Cleanup\n      return () => {\n        if (notificationListener.current) {\n          (0, _notifications.removeNotificationSubscription)(notificationListener.current);\n        }\n        if (responseListener.current) {\n          (0, _notifications.removeNotificationSubscription)(responseListener.current);\n        }\n        subscription.remove();\n      };\n    }, []);\n    return {\n      expoPushToken,\n      notification,\n      isRegistered,\n      error,\n      registerForNotifications\n    };\n  }\n  _s(useNotifications, \"uNzfRMPxaWA46y1dFQUPsReSj4o=\");\n});","lineCount":103,"map":[[7,2,1,0],[7,6,1,0,"_react"],[7,12,1,0],[7,15,1,0,"require"],[7,22,1,0],[7,23,1,0,"_dependencyMap"],[7,37,1,0],[8,2,1,52],[8,6,1,52,"_AppState"],[8,15,1,52],[8,18,1,52,"_interopRequireDefault"],[8,40,1,52],[8,41,1,52,"require"],[8,48,1,52],[8,49,1,52,"_dependencyMap"],[8,63,1,52],[9,2,4,0],[9,6,4,0,"_notifications"],[9,20,4,0],[9,23,4,0,"require"],[9,30,4,0],[9,31,4,0,"_dependencyMap"],[9,45,4,0],[10,2,11,0],[10,6,11,0,"_apiConfig"],[10,16,11,0],[10,19,11,0,"require"],[10,26,11,0],[10,27,11,0,"_dependencyMap"],[10,41,11,0],[11,2,11,40],[11,6,11,40,"_s"],[11,8,11,40],[11,11,11,40,"$RefreshSig$"],[11,23,11,40],[12,2,21,0],[13,0,22,0],[14,0,23,0],[15,0,24,0],[16,0,25,0],[17,0,26,0],[18,0,27,0],[19,0,28,0],[20,0,29,0],[21,0,30,0],[22,0,31,0],[23,0,32,0],[24,0,33,0],[25,0,34,0],[26,0,35,0],[27,2,36,7],[27,11,36,16,"useNotifications"],[27,27,36,32,"useNotifications"],[27,28,36,32],[27,30,36,59],[28,4,36,59,"_s"],[28,6,36,59],[29,4,37,2],[29,10,37,8],[29,11,37,9,"expoPushToken"],[29,24,37,22],[29,26,37,24,"setExpoPushToken"],[29,42,37,40],[29,43,37,41],[29,46,37,44],[29,50,37,44,"useState"],[29,65,37,52],[29,67,37,68],[29,71,37,72],[29,72,37,73],[30,4,38,2],[30,10,38,8],[30,11,38,9,"notification"],[30,23,38,21],[30,25,38,23,"setNotification"],[30,40,38,38],[30,41,38,39],[30,44,38,42],[30,48,38,42,"useState"],[30,63,38,50],[30,65,38,86],[30,69,38,90],[30,70,38,91],[31,4,39,2],[31,10,39,8],[31,11,39,9,"isRegistered"],[31,23,39,21],[31,25,39,23,"setIsRegistered"],[31,40,39,38],[31,41,39,39],[31,44,39,42],[31,48,39,42,"useState"],[31,63,39,50],[31,65,39,51],[31,70,39,56],[31,71,39,57],[32,4,40,2],[32,10,40,8],[32,11,40,9,"error"],[32,16,40,14],[32,18,40,16,"setError"],[32,26,40,24],[32,27,40,25],[32,30,40,28],[32,34,40,28,"useState"],[32,49,40,36],[32,51,40,52],[32,55,40,56],[32,56,40,57],[33,4,42,2],[33,10,42,8,"notificationListener"],[33,30,42,28],[33,33,42,31],[33,37,42,31,"useRef"],[33,50,42,37],[33,52,42,66],[33,53,42,67],[34,4,43,2],[34,10,43,8,"responseListener"],[34,26,43,24],[34,29,43,27],[34,33,43,27,"useRef"],[34,46,43,33],[34,48,43,62],[34,49,43,63],[35,4,44,2],[35,10,44,8,"appState"],[35,18,44,16],[35,21,44,19],[35,25,44,19,"useRef"],[35,38,44,25],[35,40,44,26,"AppState"],[35,57,44,34],[35,58,44,35,"currentState"],[35,70,44,47],[35,71,44,48],[36,4,46,2],[36,10,46,8,"registerForNotifications"],[36,34,46,32],[36,37,46,35],[36,43,46,35,"registerForNotifications"],[36,44,46,35],[36,49,46,47],[37,6,47,4],[37,10,47,8],[38,8,48,6,"setError"],[38,16,48,14],[38,17,48,15],[38,21,48,19],[38,22,48,20],[39,8,49,6],[39,14,49,12,"token"],[39,19,49,17],[39,22,49,20],[39,28,49,26],[39,32,49,26,"registerForPushNotificationsAsync"],[39,80,49,59],[39,82,49,60],[39,83,49,61],[40,8,51,6],[40,12,51,10,"token"],[40,17,51,15],[40,19,51,17],[41,10,52,8,"setExpoPushToken"],[41,26,52,24],[41,27,52,25,"token"],[41,32,52,30],[41,33,52,31],[42,10,53,8,"setIsRegistered"],[42,25,53,23],[42,26,53,24],[42,30,53,28],[42,31,53,29],[44,10,55,8],[45,10,56,8],[45,14,56,12,"API_BASE"],[45,33,56,20],[45,35,56,22],[46,12,57,10],[46,18,57,16],[46,22,57,16,"sendPushTokenToBackend"],[46,59,57,38],[46,61,57,39,"token"],[46,66,57,44],[46,68,57,46,"API_BASE"],[46,87,57,54],[46,88,57,55],[47,10,58,8],[48,8,59,6],[48,9,59,7],[48,15,59,13],[49,10,60,8,"setError"],[49,18,60,16],[49,19,60,17],[49,58,60,56],[49,59,60,57],[50,8,61,6],[51,6,62,4],[51,7,62,5],[51,8,62,6],[51,15,62,13,"err"],[51,18,62,16],[51,20,62,18],[52,8,63,6,"setError"],[52,16,63,14],[52,17,63,15,"err"],[52,20,63,18],[52,32,63,30,"Error"],[52,37,63,35],[52,40,63,38,"err"],[52,43,63,41],[52,44,63,42,"message"],[52,51,63,49],[52,54,63,52],[52,69,63,67],[52,70,63,68],[53,6,64,4],[54,4,65,2],[54,5,65,3],[55,4,67,2],[55,8,67,2,"useEffect"],[55,24,67,11],[55,26,67,12],[55,32,67,18],[56,6,68,4],[57,6,69,4,"registerForNotifications"],[57,30,69,28],[57,31,69,29],[57,32,69,30],[59,6,71,4],[60,6,72,4,"notificationListener"],[60,26,72,24],[60,27,72,25,"current"],[60,34,72,32],[60,37,72,35],[60,41,72,35,"addNotificationReceivedListener"],[60,87,72,66],[60,89,72,68,"notif"],[60,94,72,73],[60,98,72,78],[61,8,73,6,"setNotification"],[61,23,73,21],[61,24,73,22,"notif"],[61,29,73,27],[61,30,73,28],[62,6,74,4],[62,7,74,5],[62,8,74,6],[63,6,76,4,"responseListener"],[63,22,76,20],[63,23,76,21,"current"],[63,30,76,28],[63,33,76,31],[63,37,76,31,"addNotificationResponseReceivedListener"],[63,91,76,70],[63,93,76,72,"response"],[63,101,76,80],[63,105,76,85],[64,8,77,6],[65,8,78,6],[65,14,78,12,"data"],[65,18,78,16],[65,21,78,19,"response"],[65,29,78,27],[65,30,78,28,"notification"],[65,42,78,40],[65,43,78,41,"request"],[65,50,78,48],[65,51,78,49,"content"],[65,58,78,56],[65,59,78,57,"data"],[65,63,78,61],[66,8,79,6,"console"],[66,15,79,13],[66,16,79,14,"log"],[66,19,79,17],[66,20,79,18],[66,42,79,40],[66,44,79,42,"data"],[66,48,79,46],[66,49,79,47],[68,8,81,6],[69,6,82,4],[69,7,82,5],[69,8,82,6],[71,6,84,4],[72,6,85,4],[72,12,85,10,"handleAppStateChange"],[72,32,85,30],[72,35,85,34,"nextAppState"],[72,47,85,62],[72,51,85,67],[73,8,86,6],[73,12,87,8,"appState"],[73,20,87,16],[73,21,87,17,"current"],[73,28,87,24],[73,29,87,25,"match"],[73,34,87,30],[73,35,87,31],[73,56,87,52],[73,57,87,53],[73,61,88,8,"nextAppState"],[73,73,88,20],[73,78,88,25],[73,86,88,33],[73,88,89,8],[74,10,90,8],[75,10,91,8],[75,14,91,12],[75,15,91,13,"isRegistered"],[75,27,91,25],[75,29,91,27],[76,12,92,10,"registerForNotifications"],[76,36,92,34],[76,37,92,35],[76,38,92,36],[77,10,93,8],[78,8,94,6],[79,8,95,6,"appState"],[79,16,95,14],[79,17,95,15,"current"],[79,24,95,22],[79,27,95,25,"nextAppState"],[79,39,95,37],[80,6,96,4],[80,7,96,5],[81,6,98,4],[81,12,98,10,"subscription"],[81,24,98,22],[81,27,98,25,"AppState"],[81,44,98,33],[81,45,98,34,"addEventListener"],[81,61,98,50],[81,62,98,51],[81,70,98,59],[81,72,98,61,"handleAppStateChange"],[81,92,98,81],[81,93,98,82],[83,6,100,4],[84,6,101,4],[84,13,101,11],[84,19,101,17],[85,8,102,6],[85,12,102,10,"notificationListener"],[85,32,102,30],[85,33,102,31,"current"],[85,40,102,38],[85,42,102,40],[86,10,103,8],[86,14,103,8,"removeNotificationSubscription"],[86,59,103,38],[86,61,103,39,"notificationListener"],[86,81,103,59],[86,82,103,60,"current"],[86,89,103,67],[86,90,103,68],[87,8,104,6],[88,8,105,6],[88,12,105,10,"responseListener"],[88,28,105,26],[88,29,105,27,"current"],[88,36,105,34],[88,38,105,36],[89,10,106,8],[89,14,106,8,"removeNotificationSubscription"],[89,59,106,38],[89,61,106,39,"responseListener"],[89,77,106,55],[89,78,106,56,"current"],[89,85,106,63],[89,86,106,64],[90,8,107,6],[91,8,108,6,"subscription"],[91,20,108,18],[91,21,108,19,"remove"],[91,27,108,25],[91,28,108,26],[91,29,108,27],[92,6,109,4],[92,7,109,5],[93,4,110,2],[93,5,110,3],[93,7,110,5],[93,9,110,7],[93,10,110,8],[94,4,112,2],[94,11,112,9],[95,6,113,4,"expoPushToken"],[95,19,113,17],[96,6,114,4,"notification"],[96,18,114,16],[97,6,115,4,"isRegistered"],[97,18,115,16],[98,6,116,4,"error"],[98,11,116,9],[99,6,117,4,"registerForNotifications"],[100,4,118,2],[100,5,118,3],[101,2,119,0],[102,2,119,1,"_s"],[102,4,119,1],[102,5,36,16,"useNotifications"],[102,21,36,32],[103,0,36,32],[103,3]],"functionMap":{"names":["<global>","useNotifications","registerForNotifications","useEffect$argument_0","addNotificationReceivedListener$argument_0","addNotificationResponseReceivedListener$argument_0","handleAppStateChange","<anonymous>"],"mappings":"AAA;OCmC;mCCU;GDmB;YEE;mECK;KDE;uEEE;KFM;iCGG;KHW;WIK;KJQ;GFC;CDS"}},"type":"js/module"}]}